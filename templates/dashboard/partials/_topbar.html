<!-- Top Bar -->
<header class="fixed top-0 left-0 right-0 z-50 backdrop-blur-lg border-b shadow-xl" style="background-color: #00072D; border-color: rgba(255, 255, 255, 0.1);">
    <div class="flex items-center justify-between px-4 sm:px-6 lg:px-8 h-16">
        <!-- Left: Brand + Dashboard Title -->
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-3">
                <!-- Logo -->
                {% load static %}
                <div class="flex items-center justify-center h-8 w-8 flex-shrink-0 transition-transform hover:scale-105">
                    <img src="{% static 'dashboard/blinkr-b-logo.svg' %}" alt="Blinkr Analytics Dashboard Logo" class="h-full w-full object-contain" style="max-height: 32px; max-width: 32px;" onerror="this.style.display='none';">
                </div>
                <div class="hidden sm:block">
                    <h1 class="text-base font-bold text-white tracking-tight leading-tight">Blinkr Analytics Dashboard</h1>
                </div>
            </div>
        </div>
        
        <!-- Middle: Data Refresh Status -->
        <div class="hidden md:flex items-center gap-3">
            <div class="flex items-center gap-2.5 px-3 py-1.5 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg">
                <div class="flex items-center gap-2">
                    <span class="relative flex h-2 w-2">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                    </span>
                    <span class="text-xs font-medium text-white/90">Refresh:</span>
                    <span id="refresh-countdown" class="text-xs font-bold text-white">10s</span>
                </div>
            </div>
            <button 
                id="pause-refresh-btn"
                class="px-3 py-1.5 text-xs font-semibold text-white/90 hover:text-white bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-lg transition-all duration-200 hover:shadow-md active:scale-95"
                aria-label="Pause refresh"
            >
                <span class="flex items-center gap-1.5">
                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Pause
                </span>
            </button>
        </div>
        
        <!-- Right: Last Updated + User Menu -->
        <div class="flex items-center gap-3">
            <div class="hidden lg:flex items-center gap-2 px-3 py-1.5 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg">
                <svg class="w-3.5 h-3.5 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-xs text-white/70 font-medium">Updated:</span>
                <span id="last-updated-time" class="text-xs text-white font-semibold tabular-nums">
                    {% if last_updated %}{{ last_updated }}{% else %}--{% endif %}
                </span>
            </div>
            
            <!-- Refresh Interval Dropdown -->
            <div class="relative">
                <select 
                    id="refresh-interval-select"
                    class="appearance-none bg-white/10 backdrop-blur-sm border border-white/20 text-white text-xs font-medium px-3 py-1.5 pr-8 rounded-lg hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 cursor-pointer transition-all duration-200 shadow-sm hover:shadow-md"
                >
                    <option value="10" class="bg-gray-800 text-white">10s</option>
                    <option value="30" class="bg-gray-800 text-white">30s</option>
                    <option value="60" class="bg-gray-800 text-white">60s</option>
                    <option value="0" class="bg-gray-800 text-white">Manual</option>
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                    <svg class="w-3.5 h-3.5 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
            </div>
            
            <!-- Theme Toggle -->
            <button 
                id="theme-toggle"
                class="p-2 text-white/90 hover:text-white bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-lg transition-all duration-200 hover:shadow-md active:scale-95"
                aria-label="Toggle theme"
                onclick="toggleTheme()"
            >
                <!-- Sun icon (light mode) -->
                <svg id="theme-toggle-light-icon" class="w-4.5 h-4.5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <!-- Moon icon (dark mode) -->
                <svg id="theme-toggle-dark-icon" class="w-4.5 h-4.5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
            
            <!-- User Menu -->
            <div class="flex items-center gap-2 pl-2 border-l border-white/20">
                <div class="hidden sm:flex items-center gap-2 px-3 py-1.5 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg">
                    <svg class="w-3.5 h-3.5 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span class="text-xs text-white/70 font-medium">Welcome,</span>
                    <span class="text-xs text-white font-semibold">
                        {% if user %}
                            {% if user.first_name or user.last_name %}
                                {{ user.first_name }} {{ user.last_name }}
                            {% elif request.session.employee_f_name or request.session.employee_l_name %}
                                {{ request.session.employee_f_name }} {{ request.session.employee_l_name }}
                            {% else %}
                                {{ user.username|default:"admin" }}
                            {% endif %}
                        {% else %}
                            admin
                        {% endif %}
                    </span>
                </div>
                <form method="post" action="{% url 'logout' %}" class="inline">
                    {% csrf_token %}
                    <button 
                        type="submit"
                        class="px-3 py-1.5 text-xs font-semibold text-white/90 hover:text-white bg-white/10 hover:bg-red-500/80 backdrop-blur-sm border border-white/20 hover:border-red-400/50 rounded-lg transition-all duration-200 hover:shadow-md active:scale-95 flex items-center gap-1.5"
                    >
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        Logout
                    </button>
                </form>
            </div>
        </div>
    </div>
</header>

